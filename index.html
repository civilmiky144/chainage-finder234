<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="theme-color" content="#004a99">
<title>BPPTPL Chainage Finder</title>
<style>
:root{
    --bppt-blue: #004a99;
    --bppt-green: #28a745;
    --safety-orange: #FF8C00;
    --bg: #f4f7f6;
}
*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent}
body{
    color: #1f2937;
    font-family: -apple-system, system-ui, sans-serif;
    background: var(--bg);
    display: flex;
    flex-direction: column;
    height: 100vh;
    height: 100dvh;
}

/* HORIZONTAL CENTERED HEADER */
header {
    background: white;
    padding: 15px 16px;
    border-bottom: 4px solid var(--bppt-blue);
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: center;
    gap: 12px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    flex-shrink: 0;
}
.logo { height: 45px; width: auto; }
.header-text { text-align: left; }
.header-text h1 { margin: 0; font-size: 13px; color: var(--bppt-blue); text-transform: uppercase; line-height: 1.2; }
.header-text p { margin: 2px 0 0 0; font-size: 10px; color: var(--bppt-green); font-weight: bold; letter-spacing: 0.5px; }

.main-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 20px;
}

/* BIG CHAINAGE DISPLAY */
.ch-card {
    background: white;
    border: 1px solid #d1d5db;
    border-radius: 20px;
    width: 100%;
    padding: 40px 15px;
    text-align: center;
    box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1);
    margin-bottom: 20px;
}
.label {
    font-size: 11px;
    letter-spacing: 3px;
    color: #6b7280;
    margin-bottom: 15px;
    font-weight: 800;
    text-transform: uppercase;
}
#chValue {
    font-size: 14vw;
    font-weight: 900;
    color: var(--safety-orange);
    font-family: 'Courier New', Courier, monospace;
    white-space: nowrap;
}

/* SECTION INFO CARD */
.section-card {
    background: #eef2ff;
    border: 1px solid #c7d2fe;
    border-radius: 15px;
    padding: 15px;
    width: 100%;
    margin-bottom: 20px;
    display: none;
}
.sec-title { font-size: 14px; font-weight: 800; color: var(--bppt-blue); border-bottom: 1px solid #c7d2fe; padding-bottom: 5px; margin-bottom: 10px; text-align: center; }
.sec-detail { font-size: 13px; margin: 4px 0; }
.sec-phone { color: var(--bppt-blue); text-decoration: none; font-weight: bold; display: inline-flex; align-items: center; gap: 8px; margin-top: 5px; }

.btn {
    width: 100%;
    padding: 18px;
    border-radius: 15px;
    border: none;
    font-size: 14px;
    font-weight: 800;
    text-transform: uppercase;
    cursor: pointer;
    transition: 0.2s;
}
.btn-primary { background: var(--bppt-blue); color: white; }
.btn-stop { background: #ef4444; color: white; }

footer {
    padding: 15px;
    background: white;
    text-align: center;
    border-top: 1px solid #e5e7eb;
    font-size: 12px;
    color: #4b5563;
}
</style>
</head>
<body>

<header>
    <img src="1000678935.png" alt="Logo" class="logo">
    <div class="header-text">
        <h1>Beawar Pali Pindwara Tollway</h1>
        <p>MAINTENANCE DEPARTMENT</p>
    </div>
</header>

<div class="main-content">
    <div class="ch-card">
        <div class="label">Current Chainage</div>
        <div id="chValue">--+---</div>
    </div>

    <div class="section-card" id="sectionCard">
        <div class="sec-title" id="secTitle">SECTION --</div>
        <div class="sec-detail">In-charge: <strong id="secName">--</strong></div>
        <a href="" class="sec-phone" id="secLink">
            <span>&#9742;</span> <span id="secPhone">--</span>
        </a>
    </div>

    <button class="btn btn-primary" id="btnTrack" onclick="toggleTracking()">Want Your Chainage Click Me</button>
</div>

<footer>
    Prepared by - <strong>Mukesh Kumar Kollepara</strong> (Sr.Manager)
</footer>

<script>
// PASTE YOUR FULL 4889 POINTS HERE
const CHAIN_PTS=[
["0+000",26.0617792,74.2991350],
["0+050",26.0619805,74.2986852],
// ...
["244+354",24.7800582,73.0298757]
];

const SECTION_DATA = {
    1: { name: "Mr. Sachin Gupta", phone: "8506878948" },
    2: { name: "Mr. Amit Khemwani", phone: "6375884003" },
    3: { name: "Section Incharge", phone: "9529826416" },
    4: { name: "Mr. Bhagwat Rathore", phone: "8619494508" }
};

let isTracking = false, watchId = null;

function toggleTracking() {
    const btn = document.getElementById("btnTrack");
    if (isTracking) {
        navigator.geolocation.clearWatch(watchId);
        isTracking = false;
        btn.textContent = "Want Your Chainage Click Me";
        btn.className = "btn btn-primary";
        document.getElementById("sectionCard").style.display = "none";
    } else {
        isTracking = true;
        btn.textContent = "Stop Tracking";
        btn.className = "btn btn-stop";
        watchId = navigator.geolocation.watchPosition(pos => {
            const lat = pos.coords.latitude;
            const lon = pos.coords.longitude;
            
            let minD = Infinity;
            let nearestTag = "--+---";

            // Simple fast Pythagorean lookup for speed
            for (let i = 0; i < CHAIN_PTS.length; i++) {
                let d = Math.sqrt(Math.pow(lat - CHAIN_PTS[i][1], 2) + Math.pow(lon - CHAIN_PTS[i][2], 2));
                if (d < minD) {
                    minD = d;
                    nearestTag = CHAIN_PTS[i][0];
                }
            }

            document.getElementById("chValue").textContent = nearestTag;
            
            // Section Logic
            const km = parseInt(nearestTag.split('+')[0]);
            let sNum = km >= 180 ? 4 : km >= 120 ? 3 : km >= 60 ? 2 : 1;
            const data = SECTION_DATA[sNum];
            document.getElementById("sectionCard").style.display = "block";
            document.getElementById("secTitle").textContent = "SECTION " + sNum;
            document.getElementById("secName").textContent = data.name;
            document.getElementById("secPhone").textContent = data.phone;
            document.getElementById("secLink").href = "tel:" + data.phone;

        }, null, {enableHighAccuracy: true});
    }
}
</script>
</body>
</html>
